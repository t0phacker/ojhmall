<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="signUp">
	<!-- 회원정보 입력 -->
	<insert id="insertUser" parameterType="ojhmall.vo.User" >
    <![CDATA[
        INSERT INTO user
        (
            userType,
            id, 
            userPassword, 
            userName, 
            newDate, 
            newUser, 
            updateDate,
            updateUser
        )
        VALUES
        (
            #{userTypeNum}, 
            #{id},
            #{userPassword},
            #{userName},
            default,
            1, 
            default, 
            1
        )
    ]]>
	</insert>
	
	<select id ="selectUserNum" parameterType="ojhmall.vo.User" resultType="int">
		SELECT 
			userNumber
		FROM
			user
		WHERE
			id = #{id} and userPassword = #{userPassword}
	</select>
	<update id="updateUser" parameterType="ojhmall.vo.User"> 
		<![CDATA[ 
			UPDATE
		 		user 
		 	SET 
		 		newUSER = #{userNumber}, updateUser = #{userNumber}
		 	WHERE 
		 		userNumber = #{userNumber} 
		 ]]>
	</update>

	<insert id="insertCustomer" parameterType="ojhmall.vo.Customer">
    <![CDATA[
        INSERT INTO customer
        (
            user_userNumber,
            phNumber, 
            address, 
            zipCode
        )
        VALUES
        (
            #{userNumber}, 
            #{phNumber},
            #{address},
            #{zipCode}
        )
    ]]>
	</insert>

	<insert id="insertUser2" parameterType="ojhmall.vo.Seller">
    <![CDATA[
        INSERT INTO user
        (
            userType,
            id, 
            userPassword, 
            userName, 
            newDate, 
            newUser, 
            updateDate,
            updateUser
        )
        VALUES
        (
            2, 
            #{id},
            #{userPassword},
            #{userName},
            default,
            1, 
            default, 
            1
        )
    ]]>
	</insert>

	<select id="updateUser2" parameterType="ojhmall.vo.Seller"> 
		<![CDATA[ UPDATE user SET newUSER = #{userNumber} WHERE userNumber = #{userNumber} ]]>
	</select>

	<insert id="insertSeller" parameterType="ojhmall.vo.Seller">
    <![CDATA[
        INSERT INTO seller
        (
            user_userNumber,
            phNumber, 
            address, 
            zipCode,
            bizNumber,
            accNumber
        )
        VALUES
        (
            #{userNumber}, 
            #{phNumber},
            #{address},
            #{zipCode},
            #{bizNumber},
            #{accNumber}
        )
    ]]>
	</insert>
	<!-- 관리자 회원 정보 업데이트 -->
	<update id="updateAdmin" parameterType="ojhmall.vo.Admin"> 
		<![CDATA[ UPDATE user SET userName = #{userName}, userPassword = #{userPassword} WHERE userNumber = #{userNumber} ]]>
	</update>
	<!-- 구매자 회원 기본 정보 업데이트 -->
	<update id="updateCustomer" parameterType="ojhmall.vo.Customer"> 
		<![CDATA[ UPDATE user SET userName = #{userName}, userPassword = #{userPassword} WHERE userNumber = #{userNumber} ]]>
	</update>
	<!-- 구매자 회원 부가 정보 업데이트 -->
	<update id="updateCustomerMoreInfo" parameterType="ojhmall.vo.Customer"> 
		<![CDATA[ UPDATE customer SET phNumber = #{phNumber}, address = #{address}, zipCode = #{zipCode} WHERE user_userNumber = #{userNumber} ]]>
	</update>
	<!-- 판매자 회원 기본 정보 업데이트 -->
	<update id="updateSeller" parameterType="ojhmall.vo.Seller"> 
		<![CDATA[ UPDATE user SET userName = #{userName}, userPassword = #{userPassword} WHERE userNumber = #{userNumber} ]]>
	</update>
	<!-- 판매자 회원 부가 정보 업데이트 -->
	<update id="updateSellerMoreInfo" parameterType="ojhmall.vo.Seller"> 
		<![CDATA[ UPDATE seller SET phNumber = #{phNumber}, address = #{address}, zipCode = #{zipCode}, bizNumber = #{bizNumber}, accNumber = #{accNumber} WHERE user_userNumber = #{userNumber} ]]>
	</update>

	<select id="signUp.updatingUser" parameterType="ojhmall.vo.User"
		resultType="ojhmall.vo.User">
		<![CDATA[
			SELECT
				userNumber, id, userPassword, userName, userType
			FROM
			    user u
			WHERE u.userNumber=#{userNumber}
		]]>
	</select>
	
	<!-- 회원정보 삭제 -->
	<update id="removeUser" parameterType="ojhmall.vo.User"> 
		<![CDATA[ UPDATE user SET id = #{id}, userPassword = "discarded", userName = "discarded", userType = 4 WHERE userNumber = #{userNumber} ]]>
	</update>
	<update id="removeAdmin" parameterType="ojhmall.vo.User"> 
		<![CDATA[ UPDATE admin SET adminType = 0, accNumber = "discarded" WHERE user_userNumber = #{userNumber} ]]>
	</update>
	<update id="removeCustomer" parameterType="ojhmall.vo.User"> 
		<![CDATA[ UPDATE customer SET phNumber = "discarded", address = "discarded", zipCode = "discarded" WHERE user_userNumber = #{userNumber} ]]>
	</update>
	<update id="removeSeller" parameterType="ojhmall.vo.User"> 
		<![CDATA[ UPDATE seller SET phNumber = "discarded", address = "discarded", zipCode = "discarded", bizNumber = "discarded", accNumber = "discarded" WHERE user_userNumber = #{userNumber} ]]>
	</update>
	<insert id="saveQuery" parameterType="java.util.Map">
    <![CDATA[
        INSERT INTO test
        values(#{test})
    ]]>
	</insert>
</mapper>

